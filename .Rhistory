# El orden es: parámetros de las marginales + parámetro de la cópula
start_clayton <- c(alpha, beta, kappa, lambda, 1)
start_gumbel  <- c(alpha, beta, kappa, lambda, 1.2)
start_frank   <- c(alpha, beta, kappa, lambda, 1)
# Ajustar los modelos
fit_mvdc_clayton <- fitMvdc(as.matrix(datos), modelo_clayton, start = start_clayton)
fit_mvdc_gumbel  <- fitMvdc(as.matrix(datos), modelo_gumbel,  start = start_gumbel)
fit_mvdc_frank   <- fitMvdc(as.matrix(datos), modelo_frank,   start = start_frank)
fit_mvdc_clayton
fit_mvdc_gumbel
fit_mvdc_frank
#| warning: false
#| message: false
library(copula)
alpha <- fit_gamma$estimate["shape"]
beta  <- fit_gamma$estimate["rate"]
kappa <- fit_weibull$estimate["shape"]
lambda <- fit_weibull$estimate["scale"]
marginales <- c("gamma", "weibull")
param_marg <- list(
list(shape = alpha, rate = beta),
list(shape = kappa, scale = lambda)
)
modelo_clayton <- mvdc(
copula = claytonCopula(param = 1, dim = 2),
margins = marginales,
paramMargins = param_marg
)
modelo_gumbel <- mvdc(
copula = gumbelCopula(param = 1.2, dim = 2),
margins = marginales,
paramMargins = param_marg
)
modelo_frank <- mvdc(
copula = frankCopula(param = 1, dim = 2),
margins = marginales,
paramMargins = param_marg
)
start_clayton <- c(alpha, beta, kappa, lambda, 1)
start_gumbel  <- c(alpha, beta, kappa, lambda, 1.2)
start_frank   <- c(alpha, beta, kappa, lambda, 1)
fit_mvdc_clayton <- fitMvdc(as.matrix(datos), modelo_clayton, start = start_clayton)
fit_mvdc_gumbel  <- fitMvdc(as.matrix(datos), modelo_gumbel,  start = start_gumbel)
fit_mvdc_frank   <- fitMvdc(as.matrix(datos), modelo_frank,   start = start_frank)
fit_mvdc_clayton
fit_mvdc_gumbel
fit_mvdc_frank
#| warning: false
#| message: false
library(copula)
alpha <- fit_gamma$estimate["shape"]
beta  <- fit_gamma$estimate["rate"]
kappa <- fit_weibull$estimate["shape"]
lambda <- fit_weibull$estimate["scale"]
marginales <- c("gamma", "weibull")
param_marg <- list(
list(shape = alpha, rate = beta),
list(shape = kappa, scale = lambda)
)
modelo_clayton <- mvdc(
copula = claytonCopula(param = 1, dim = 2),
margins = marginales,
paramMargins = param_marg
)
modelo_gumbel <- mvdc(
copula = gumbelCopula(param = 1.2, dim = 2),
margins = marginales,
paramMargins = param_marg
)
modelo_frank <- mvdc(
copula = frankCopula(param = 1, dim = 2),
margins = marginales,
paramMargins = param_marg
)
start_clayton <- c(alpha, beta, kappa, lambda, 1)
start_gumbel  <- c(alpha, beta, kappa, lambda, 1.2)
start_frank   <- c(alpha, beta, kappa, lambda, 1)
fit_mvdc_clayton <- fitMvdc(as.matrix(datos), modelo_clayton, start = start_clayton)
fit_mvdc_gumbel  <- fitMvdc(as.matrix(datos), modelo_gumbel,  start = start_gumbel)
fit_mvdc_frank   <- fitMvdc(as.matrix(datos), modelo_frank,   start = start_frank)
print("Ajsute de la Cópula Clayton /n")
fit_mvdc_clayton
print("\n Ajuste de la Cópula Gumbel /n")
fit_mvdc_gumbel
print("/n Ajuste de la Cópula Frank /n")
fit_mvdc_frank
#| warning: false
#| message: false
library(copula)
alpha <- fit_gamma$estimate["shape"]
beta  <- fit_gamma$estimate["rate"]
kappa <- fit_weibull$estimate["shape"]
lambda <- fit_weibull$estimate["scale"]
marginales <- c("gamma", "weibull")
param_marg <- list(
list(shape = alpha, rate = beta),
list(shape = kappa, scale = lambda)
)
modelo_clayton <- mvdc(
copula = claytonCopula(param = 1, dim = 2),
margins = marginales,
paramMargins = param_marg
)
modelo_gumbel <- mvdc(
copula = gumbelCopula(param = 1.2, dim = 2),
margins = marginales,
paramMargins = param_marg
)
modelo_frank <- mvdc(
copula = frankCopula(param = 1, dim = 2),
margins = marginales,
paramMargins = param_marg
)
start_clayton <- c(alpha, beta, kappa, lambda, 1)
start_gumbel  <- c(alpha, beta, kappa, lambda, 1.2)
start_frank   <- c(alpha, beta, kappa, lambda, 1)
fit_mvdc_clayton <- fitMvdc(as.matrix(datos), modelo_clayton, start = start_clayton)
fit_mvdc_gumbel  <- fitMvdc(as.matrix(datos), modelo_gumbel,  start = start_gumbel)
fit_mvdc_frank   <- fitMvdc(as.matrix(datos), modelo_frank,   start = start_frank)
print("Ajsute de la Cópula Clayton /n")
fit_mvdc_clayton
print("/n Ajuste de la Cópula Gumbel /n")
fit_mvdc_gumbel
print("/n Ajuste de la Cópula Frank /n")
fit_mvdc_frank
cat("Ajsute de la Cópula Clayton /n")
cat("Ajsute de la Cópula Clayton \n")
fit_mvdc_clayton
cat("\n Ajuste de la Cópula Gumbel \n")
#| warning: false
#| message: false
library(copula)
alpha <- fit_gamma$estimate["shape"]
beta  <- fit_gamma$estimate["rate"]
kappa <- fit_weibull$estimate["shape"]
lambda <- fit_weibull$estimate["scale"]
marginales <- c("gamma", "weibull")
param_marg <- list(
list(shape = alpha, rate = beta),
list(shape = kappa, scale = lambda)
)
modelo_clayton <- mvdc(
copula = claytonCopula(param = 1, dim = 2),
margins = marginales,
paramMargins = param_marg
)
modelo_gumbel <- mvdc(
copula = gumbelCopula(param = 1.2, dim = 2),
margins = marginales,
paramMargins = param_marg
)
modelo_frank <- mvdc(
copula = frankCopula(param = 1, dim = 2),
margins = marginales,
paramMargins = param_marg
)
start_clayton <- c(alpha, beta, kappa, lambda, 1)
start_gumbel  <- c(alpha, beta, kappa, lambda, 1.2)
start_frank   <- c(alpha, beta, kappa, lambda, 1)
fit_mvdc_clayton <- fitMvdc(as.matrix(datos), modelo_clayton, start = start_clayton)
fit_mvdc_gumbel  <- fitMvdc(as.matrix(datos), modelo_gumbel,  start = start_gumbel)
fit_mvdc_frank   <- fitMvdc(as.matrix(datos), modelo_frank,   start = start_frank)
cat("Ajsute de la Cópula Clayton \n")
fit_mvdc_clayton
cat("\n Ajuste de la Cópula Gumbel \n")
fit_mvdc_gumbel
cat("\n Ajuste de la Cópula Frank \n")
fit_mvdc_frank
theta_clayton <- coef(fit_mvdc_clayton)
theta_gumbel  <- coef(fit_mvdc_gumbel)
theta_frank   <- coef(fit_mvdc_frank)
theta_clayton
theta_gumbel
theta_frank
theta_clayton <- coef(fit_mvdc_clayton)
theta_gumbel  <- coef(fit_mvdc_gumbel)
theta_frank   <- coef(fit_mvdc_frank)
cat("Parámetros Clayton \n")
theta_clayton
cat("\n Parámetros Gumbel \n")
theta_gumbel
cat("\n Parámetros Frank \n")
theta_frank
par(mfrow=c(1,3))
# Clayton
plot(u, v, pch=19, col="gray60", cex=0.5,
main="Cópula Clayton", xlab="u", ylab="v")
contour(claytonCopula(theta_clayton, dim=2), pCopula,
add=TRUE, col="red", lwd=2)
library(ggplot2)
library(gridExtra)
# Extraer los parámetros estimados de las cópulas
theta_clayton <- fit_mvdc_clayton@copula@parameters
library(ggplot2)
library(gridExtra)
# Función para generar datos de la cópula y crear gráficos
plot_copula_density <- function(copula, main_title) {
# Generar puntos en el cuadrado unitario
u <- seq(0.01, 0.99, length.out = 50)
grid <- expand.grid(u1 = u, u2 = u)
# Calcular densidad de la cópula
grid$density <- dCopula(as.matrix(grid), copula)
# Crear gráfico de contorno
p <- ggplot(grid, aes(x = u1, y = u2, z = density)) +
geom_contour_filled() +
labs(title = main_title,
x = "u1",
y = "u2") +
theme_minimal() +
theme(legend.position = "right")
return(p)
}
# Crear gráficos para cada cópula
p1 <- plot_copula_density(fit_mvdc_clayton@copula,
paste("Cópula Clayton (θ =", round(theta_clayton, 3), ")"))
theta_clayton <- coef(fit_mvdc_clayton)
theta_gumbel  <- coef(fit_mvdc_gumbel)
theta_frank   <- coef(fit_mvdc_frank)
cat("Parámetros Clayton \n")
theta_clayton
cat("\n Parámetros Gumbel \n")
theta_gumbel
cat("\n Parámetros Frank \n")
theta_frank
library(ggplot2)
library(gridExtra)
# Función para generar datos de la cópula y crear gráficos
plot_copula_density <- function(copula, main_title) {
# Generar puntos en el cuadrado unitario
u <- seq(0.01, 0.99, length.out = 50)
grid <- expand.grid(u1 = u, u2 = u)
# Calcular densidad de la cópula
grid$density <- dCopula(as.matrix(grid), copula)
# Crear gráfico de contorno
p <- ggplot(grid, aes(x = u1, y = u2, z = density)) +
geom_contour_filled() +
labs(title = main_title,
x = "u1",
y = "u2") +
theme_minimal() +
theme(legend.position = "right")
return(p)
}
# Crear gráficos para cada cópula
p1 <- plot_copula_density(fit_mvdc_clayton@copula,
paste("Cópula Clayton (θ =", round(theta_clayton, 3), ")"))
contour(modelo_clayton, dMvdc, xlim = c(0,7))
contour(modelo_clayton, dMvdc, xlim = c(0,7), ylim = c(0,10))
contour(modelo_clayton, dMvdc, xlim = c(0,7), ylim = c(0,6))
contour(modelo_clayton, dMvdc, xlim = c(0,7), ylim = c(0,6))
contour(modelo_gumbel, dMvdc, xlim = c(0,7), ylim = c(0,6))
contour(modelo_frank, dMvdc, xlim = c(0,7), ylim = c(0,6))
par(mfrow = c(1, 3))
contour(modelo_clayton, dMvdc, xlim = c(0,7), ylim = c(0,6),
main = paste("Cópula Clayton\nθ =", round(theta_clayton, 3)),
xlab = "Variable Gamma", ylab = "Variable Weibull")
contour(modelo_gumbel, dMvdc, xlim = c(0,7), ylim = c(0,6),
main = paste("Cópula Gumbel\nθ =", round(theta_gumbel, 3)),
xlab = "Variable Gamma", ylab = "Variable Weibull")
contour(modelo_frank, dMvdc, xlim = c(0,7), ylim = c(0,6),
main = paste("Cópula Frank\nθ =", round(theta_frank, 3)),
xlab = "Variable Gamma", ylab = "Variable Weibull")
par(mfrow = c(1, 3))
contour(modelo_clayton, dMvdc, xlim = c(0,7), ylim = c(0,6),
main = 'Cópula Clayton',
xlab = "Variable Gamma", ylab = "Variable Weibull")
contour(modelo_gumbel, dMvdc, xlim = c(0,7), ylim = c(0,6),
main = 'Cópula Gumbel',
xlab = "Variable Gamma", ylab = "Variable Weibull")
contour(modelo_frank, dMvdc, xlim = c(0,7), ylim = c(0,6),
main = 'Cópula Frank',
xlab = "Variable Gamma", ylab = "Variable Weibull")
#| message: false
#| warning: false
library(tidyverse)
curva <- read.csv('../../data/curva_cero_cupon.csv')
curva <- read_excel('../../data/curva_cero_cupon.csv')
#| message: false
#| warning: false
library(tidyverse)
library(readxl)
curva <- read_excel('../../data/curva_cero_cupon.csv')
curva <- read_excel('../../data/curva_cero_cupon.xls')
curva <- read_excel('../../data/curva_cero_cupon.xlsx')
curva
colnames(curva) <- c('vencimiento', 'curva_colones', 'curva_dolares')
head(curva)
k_col <- 0.9998/1.0002
k_dol <- 0.99996/1.00004
q <- 0.5
u <- function(T, k){
return(1/((1-q)*k^(T-1)+q))
}
d <- function(T, k){
return(k^(T-1)/((1-q)*k^(T-1)+q))
}
curva <- curva %>%
mutate(
bono_colones = (1+curva_colones)^(-vencimiento),
bono_dolares = (1+curva_dolares)^(-vencimiento)
)
head(curva)
b0c_crc_venc <- c(48, 60, 120, 180, 240)
b0c_crc_valor <- rep(12000000, length(b0c_crc_venc))
bc_crc_cup_x_ano <- c(6, 3, 1)
bc_crc_cupones <- c(0.04, 0.06, 0.085)
bc_crc_venc <- c(144, 180, 216)
bc_crc_valor <- rep(22000000, length(bc_crc_venc))
acc_crc_n <- 550
acc_crc_precio_hoy <- 25000
b0c_dol_venc <- c(48, 144, 204)
b0c_dol_valor <- rep(16000, length(b0c_dol_venc))
bc_dol_cup_x_ano <- 2
bc_dol_cupones <- 0.04
bc_dol_venc <- 192
bc_dol_valor <- 25000
acc_dol_n <- 350
acc_dol_precio_hoy <- 130
#| message: false
#| warning: false
library(tidyverse)
library(readxl)
curva <- read_excel('../../data/curva_cero_cupon.xlsx')
colnames(curva) <- c('vencimiento', 'curva_colones', 'curva_dolares')
head(curva)
curva <- curva %>%
mutate(
bono_colones = (1+curva_colones)^(-vencimiento),
bono_dolares = (1+curva_dolares)^(-vencimiento)
)
head(curva)
k_col <- 0.9998/1.0002
k_dol <- 0.99996/1.00004
q <- 0.5
u <- function(T, k){
return(1/((1-q)*k^(T-1)+q))
}
d <- function(T, k){
return(k^(T-1)/((1-q)*k^(T-1)+q))
}
montecarlo_b0c <- function(venc, val_nom, df, moneda){
res <- list()
bono <- paste0('bono_', moneda)
valor_inicial <- df[[bono]][vencimiento == venc]
return(valor_inicial)
}
montecarlo_b0c(5, 10000, curva, 'colones')
curva
curva <- curva %>%
mutate(
u_col = u(vencimiento, k_col),
d_col = d(vencimiento, k_col),
u_dol = u(vencimiento, k_dol),
d_dol = d(vencimiento, k_dol)
) %>% select(-c('curva_colones', 'curva_dolares'))
head(curva)
b0c_crc_venc <- c(48, 60, 120, 180, 240)
b0c_crc_valor <- rep(12000000, length(b0c_crc_venc))
bc_crc_cup_x_ano <- c(6, 3, 1)
bc_crc_cupones <- c(0.04, 0.06, 0.085)
bc_crc_venc <- c(144, 180, 216)
bc_crc_valor <- rep(22000000, length(bc_crc_venc))
acc_crc_n <- 550
acc_crc_precio_hoy <- 25000
b0c_dol_venc <- c(48, 144, 204)
b0c_dol_valor <- rep(16000, length(b0c_dol_venc))
bc_dol_cup_x_ano <- 2
bc_dol_cupones <- 0.04
bc_dol_venc <- 192
bc_dol_valor <- 25000
acc_dol_n <- 350
acc_dol_precio_hoy <- 130
#| message: false
#| warning: false
library(tidyverse)
library(readxl)
curva <- read_excel('../../data/curva_cero_cupon.xlsx')
colnames(curva) <- c('vencimiento', 'curva_colones', 'curva_dolares')
head(curva)
curva <- curva %>%
mutate(
bono_colones = (1+curva_colones)^(-vencimiento),
bono_dolares = (1+curva_dolares)^(-vencimiento)
)
head(curva)
k_col <- 0.9998/1.0002
k_dol <- 0.99996/1.00004
q <- 0.5
u <- function(T, k){
return(1/((1-q)*k^(T-1)+q))
}
d <- function(T, k){
return(k^(T-1)/((1-q)*k^(T-1)+q))
}
curva <- curva %>%
mutate(
bono_colones = (1+curva_colones)^(-vencimiento),
bono_dolares = (1+curva_dolares)^(-vencimiento),
vencimiento = vencimiento*12
)
head(curva)
curva <- curva %>%
mutate(
bono_colones = (1+curva_colones)^(-vencimiento),
bono_dolares = (1+curva_dolares)^(-vencimiento),
vencimiento = round(vencimiento*12,0)
)
head(curva)
b0c_crc_venc <- c(48, 60, 120, 180, 240)
b0c_crc_valor <- rep(12000000, length(b0c_crc_venc))
bc_crc_cup_x_ano <- c(6, 3, 1)
bc_crc_cupones <- c(0.04, 0.06, 0.085)
bc_crc_venc <- c(144, 180, 216)
bc_crc_valor <- rep(22000000, length(bc_crc_venc))
acc_crc_n <- 550
acc_crc_precio_hoy <- 25000
b0c_dol_venc <- c(48, 144, 204)
b0c_dol_valor <- rep(16000, length(b0c_dol_venc))
bc_dol_cup_x_ano <- 2
bc_dol_cupones <- 0.04
bc_dol_venc <- 192
bc_dol_valor <- 25000
acc_dol_n <- 350
acc_dol_precio_hoy <- 130
#| message: false
#| warning: false
library(tidyverse)
library(readxl)
curva <- read_excel('../../data/curva_cero_cupon.xlsx')
colnames(curva) <- c('vencimiento', 'curva_colones', 'curva_dolares')
head(curva)
curva <- curva %>%
mutate(
bono_colones = (1+curva_colones)^(-vencimiento),
bono_dolares = (1+curva_dolares)^(-vencimiento),
vencimiento = round(vencimiento*12,0)
)
head(curva)
k_col <- 0.9998/1.0002
k_dol <- 0.99996/1.00004
q <- 0.5
u <- function(T, k){
return(1/((1-q)*k^(T-1)+q))
}
d <- function(T, k){
return(k^(T-1)/((1-q)*k^(T-1)+q))
}
view(curva)
k_col <- 0.9998/1.0002
k_dol <- 0.99996/1.00004
q <- 0.5
u <- function(T, k){
return(1/((1-q)*k^(T-1)+q))
}
d <- function(T, k){
return(k^(T-1)/((1-q)*k^(T-1)+q))
}
curva <- curva %>%
mutate(
u_col = u(vencimiento, k_col),
d_col = d(vencimiento, k_col),
u_dol = u(vencimiento, k_dol),
d_dol = d(vencimiento, k_dol)
) %>% select(-c('curva_colones', 'curva_dolares'))
head(curva)
b0c_crc_venc <- c(48, 60, 120, 180, 240)
b0c_crc_valor <- rep(12000000, length(b0c_crc_venc))
bc_crc_cup_x_ano <- c(6, 3, 1)
bc_crc_cupones <- c(0.04, 0.06, 0.085)
bc_crc_venc <- c(144, 180, 216)
bc_crc_valor <- rep(22000000, length(bc_crc_venc))
acc_crc_n <- 550
acc_crc_precio_hoy <- 25000
b0c_dol_venc <- c(48, 144, 204)
b0c_dol_valor <- rep(16000, length(b0c_dol_venc))
bc_dol_cup_x_ano <- 2
bc_dol_cupones <- 0.04
bc_dol_venc <- 192
bc_dol_valor <- 25000
acc_dol_n <- 350
acc_dol_precio_hoy <- 130
#| message: false
#| warning: false
library(tidyverse)
library(readxl)
curva <- read_excel('../../data/curva_cero_cupon.xlsx')
colnames(curva) <- c('vencimiento', 'curva_colones', 'curva_dolares')
head(curva)
curva <- curva %>%
mutate(
bono_colones = (1+curva_colones)^(-vencimiento),
bono_dolares = (1+curva_dolares)^(-vencimiento),
vencimiento = round(vencimiento*12,0)
)
head(curva)
k_col <- 0.9998/1.0002
k_dol <- 0.99996/1.00004
q <- 0.5
u <- function(T, k){
return(1/((1-q)*k^(T-1)+q))
}
d <- function(T, k){
return(k^(T-1)/((1-q)*k^(T-1)+q))
}
curva <- curva %>%
mutate(
u_col = u(vencimiento, k_col),
d_col = d(vencimiento, k_col),
u_dol = u(vencimiento, k_dol),
d_dol = d(vencimiento, k_dol)
) %>% select(-c('curva_colones', 'curva_dolares')) %>% slice(-1)
head(curva)
